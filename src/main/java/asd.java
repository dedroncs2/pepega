import com.sun.media.sound.InvalidFormatException;
import org.apache.log4j.BasicConfigurator;
import org.docx4j.jaxb.Context;
import org.docx4j.openpackaging.contenttype.ContentType;
import org.docx4j.openpackaging.exceptions.Docx4JException;
import org.docx4j.openpackaging.packages.WordprocessingMLPackage;
import org.docx4j.openpackaging.parts.PartName;
import org.docx4j.openpackaging.parts.WordprocessingML.AlternativeFormatInputPart;
import org.docx4j.relationships.Relationship;
import org.docx4j.wml.CTAltChunk;

import javax.xml.bind.JAXBException;

public class asd {
    public static void main(String[] args) throws InvalidFormatException, JAXBException, Docx4JException {
        String html = "<p><ac:structured-macro ac:name=\"toc\" ac:schema-version=\"1\" ac:macro-id=\"5dbd8a44-9715-41b6-808a-0232a7f90deb\" /></p><h1>Общая информация</h1><table class=\"wrapped\"><colgroup><col /><col /></colgroup><tbody><tr><td colspan=\"1\">Ссылка на эпик</td><td colspan=\"1\"><div class=\"content-wrapper\"><p><ac:structured-macro ac:name=\"jira\" ac:schema-version=\"1\" ac:macro-id=\"5c9c32db-8cf2-4fec-a642-b90011834ae4\"><ac:parameter ac:name=\"server\">jira</ac:parameter><ac:parameter ac:name=\"columns\">key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution</ac:parameter><ac:parameter ac:name=\"serverId\">3482d698-6ba0-3c44-8b31-cd0660994228</ac:parameter><ac:parameter ac:name=\"key\">ETP-2005</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">Ссылка на репозитарий</td><td colspan=\"1\"><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.021101\">https://github.com/mbuyakov/EFP.RSRV.021101</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.000241\">https://github.com/mbuyakov/EFP.RSRV.000241</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065801\">https://github.com/mbuyakov/EFP.RSRV.065801</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065701\">https://github.com/mbuyakov/EFP.RSRV.065701</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065501\">https://github.com/mbuyakov/EFP.RSRV.065501</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065601\">https://github.com/mbuyakov/EFP.RSRV.065601</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.029401\">https://github.com/mbuyakov/EFP.RSRV.029401</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.026701\">https://github.com/mbuyakov/EFP.RSRV.026701</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.021001\">https://github.com/mbuyakov/EFP.RSRV.021001</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.029301\">https://github.com/mbuyakov/EFP.RSRV.029301</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV\">https://github.com/mbuyakov/EFP.RSRV</a></p><p><a href=\"https://github.com/mbuyakov/ETP.RIN\">https://github.com/mbuyakov/ETP.RIN</a></p><p><a href=\"https://github.com/mbuyakov/ETP.RIN_TRSH\">https://github.com/mbuyakov/ETP.RIN_TRSH</a></p><p><a href=\"https://github.com/mbuyakov/ETP.MGN\">https://github.com/mbuyakov/ETP.MGN</a></p></td></tr><tr><td colspan=\"1\">Ссылка на документы</td><td colspan=\"1\"><a href=\"http://seafile.sm-soft.ru/d/f0f3151682b24ebdb22d/\">http://seafile.sm-soft.ru/d/f0f3151682b24ebdb22d/</a></td></tr><tr><td>Дата готовности к отладке</td><td><br /></td></tr><tr><td colspan=\"1\">Дата ИТ (тестовый стенд)</td><td colspan=\"1\"><br /></td></tr><tr><td>Дата передачи релиза в предпрод</td><td>14.10.20</td></tr><tr><td>Дата вывода в прод</td><td>04.12.2020</td></tr><tr><td colspan=\"1\">Аналитик по задаче</td><td colspan=\"1\"><div class=\"content-wrapper\"><ac:link><ri:user ri:userkey=\"0a49a41e6da1956b016dcab68dd20000\" /></ac:link></div></td></tr><tr><td colspan=\"1\">Разработчик по задаче</td><td colspan=\"1\"><div class=\"content-wrapper\"><p><ac:link><ri:user ri:userkey=\"0a49a41e6c34a562016c8a35e89c0002\" /></ac:link></p></div></td></tr></tbody></table><p><strong><br /></strong></p><h1>Описание бизнеса</h1><p>Модернизация старых услуг МПГУ. Цель модернизации: изменение логик и статусов, и переход на ЕФП.&nbsp;</p><p>Бизнес-суть всех ГУ - подача заявлений на получение:</p><ul><li>разрешение на ввод объекта в эксплуатацию;</li><li>разрешение на строительство объекта;</li><li>внесение изменений в разрешение на строительство объекта.</li></ul><p><br /></p><p>Сейчас реализовано несколько проектов в мнемониками RINx.</p><h2>Список услуг</h2><p>Выдача разрешения на ввод объекта в эксплуатацию (РВ):</p><p>021001 Выдача разрешения на ввод объекта в эксплуатацию Комитетом государственного строительного надзора города Москвы;</p><p>029301 Выдача разрешения на ввод объекта в эксплуатацию Департаментом культурного наследия города Москвы;</p><p>026701 Выдача разрешения на ввод объекта в эксплуатацию Департаментом природопользования и охраны окружающей среды города Москвы;</p><p>065601 Выдача разрешения на ввод объекта в эксплуатацию администрацией городского округа Троицк в городе Москве;</p><p>065801 Выдача разрешения на ввод объекта в эксплуатацию администрацией городского округа Щербинка в городе Москве</p><p>&nbsp;</p><p>&nbsp;Выдача разрешения на строительство / внесение изменений в разрешение на строительство (РС):</p><p>021101 Выдача разрешения на строительство / внесение изменений в разрешение на строительство Комитетом государственного строительного надзора города Москвы;</p><p>029401 Выдача разрешения на строительство / внесение изменений в разрешение на строительство Департаментом культурного наследия города Москвы;</p><p>000241 Выдача разрешения на строительство / внесение изменений в разрешение на строительство Департаментом природопользования и охраны окружающей среды города Москвы;</p><p>065501 Выдача разрешения на строительство / внесение изменений в разрешение на строительство администрацией городского округа Троицк в городе Москве;</p><p>065701 Выдача разрешения на строительство / внесение изменений в разрешение на строительство администрацией городского округа Щербинка в городе Москве</p><p><br /></p><h2>Очереди</h2><table class=\"wrapped\"><colgroup><col /> <col /> </colgroup><tbody><tr><td>021001</td><td>RIN2.ETP.REQUEST_V61</td></tr><tr><td>021101</td><td>RIN2.ETP.REQUEST_V61</td></tr><tr><td>000241</td><td>RIN_DP.ETP.REQUEST_V61</td></tr><tr><td>026701</td><td>RIN_DP.ETP.REQUEST_V61</td></tr><tr><td>065501</td><td>RIN_TR.ETP.REQUEST_V61</td></tr><tr><td>065601</td><td>RIN_TR.ETP.REQUEST_V61</td></tr><tr><td>065701</td><td>RIN_SH.ETP.REQUEST_V61</td></tr><tr><td>065801</td><td>RIN_SH.ETP.REQUEST_V61</td></tr><tr><td colspan=\"1\">029301</td><td colspan=\"1\">MGN.ETP.REQUEST_V61</td></tr><tr><td colspan=\"1\">029401</td><td colspan=\"1\">MGN.ETP.REQUEST_V61</td></tr></tbody></table><p><br /></p><h1 class=\"Uo8X3b\">Описание архитектуры</h1><h2>Сводные сведения</h2><p><strong><br /></strong></p><table class=\"wrapped\"><colgroup><col /><col /></colgroup><tbody><tr><td><p>0. ИС ОИВ и ее мнемоника для использования в наименованиях очередей/процессов</p></td><td><p class=\"auto-cursor-target\"><br /></p><table class=\"wrapped\"><tbody><tr><th>ОИВ</th><th>Мнемоника</th></tr><tr><td><span>АИС РиН 2.0</span></td><td>RIN</td></tr><tr><td><span>АИС МГН</span></td><td>MGN</td></tr></tbody></table><p class=\"auto-cursor-target\"><br /></p><table><tbody><tr><th>Мнемоника</th><th>Код ГУ</th></tr><tr><td>mgn</td><td>029301</td></tr><tr><td>mgn</td><td>029401</td></tr><tr><td>rin</td><td>021001</td></tr><tr><td colspan=\"1\">rin</td><td colspan=\"1\">021101</td></tr><tr><td colspan=\"1\">rin_dp</td><td colspan=\"1\">000241</td></tr><tr><td colspan=\"1\">rin_dp</td><td colspan=\"1\">026701</td></tr><tr><td colspan=\"1\">rin_sh</td><td colspan=\"1\">065701</td></tr><tr><td colspan=\"1\">rin_sh</td><td colspan=\"1\">065801</td></tr><tr><td colspan=\"1\">rin_tr</td><td colspan=\"1\">065501</td></tr><tr><td colspan=\"1\">rin_tr</td><td colspan=\"1\">065601</td></tr></tbody></table><p class=\"auto-cursor-target\"><br /></p></td></tr><tr><td><p>3. Тип интеграции (ЕФСП, ЕТП, смешанная)</p></td><td><p><strong>ЕФСП</strong></p></td></tr><tr><td><p>4. Системы обработки заявки (ИС ОИВ(ы), АС ГУФ, поставщики сведений (проверки сведений))<br /> &nbsp;- указать форматы взаимодействия</p></td><td><p>АИС РиН 2.0 / АИС МГН &ndash; v.6.1 (заявки/статусы)</p><p>MQ/JMS, v.6.1</p></td></tr><tr><td><p>5. Каналы подачи (Мос, МПГУ, АИС МФЦ, АС ГУФ, Мобильное приложение)<br /> &nbsp; &nbsp; - указать форматы взаимодействия</p></td><td><p>МПГУ &ndash; REST/JSON в ЕФСП</p><p><strong>В заявке должна уходить ссылка на ПФ!</strong></p></td></tr><tr><td><p>6. Категории заявителей (ФЛ, ЮЛ, ИП) и требуется ли формирование ЭП<br /> &nbsp; &nbsp;- алгоритм для расчета хэша (если отличается от стандартного)</p></td><td><p>ЮЛ и ИП</p><p>Требуется ЭП для подписания заявок/статусов</p></td></tr><tr><td><p>7. Требуется ли формирование ПДФ заявки<br /> &nbsp; &nbsp; &nbsp;- приложить шаблон и/или ссылку на макет формы и/или ЧТЗ на форму<br /> &nbsp; &nbsp; &nbsp;- указать код документа в ЦХЭД и его класс (если отличаются от стандартных)<br /> &nbsp; &nbsp; &nbsp;- указать, должен ли ПДФ доставляться в ЕЛК и в каком статусе (чаще 1010)<br /> &nbsp; &nbsp; &nbsp;- убедиться, что в схеме заявки для данных, передаваемых кодом по справочнику, есть данные для разименования и приложить схему и пример заявки для всех категорий заявителя</p></td><td><p>&nbsp;</p><p>Да, на статусе 1010</p></td></tr><tr><td><p>8. Требуется ли формирование статусов на стороне ЕТП и каких (чаще 1010)<br /> &nbsp; &nbsp; &nbsp; - указать код статуса (+ возможно ризенКод)<br /> &nbsp; &nbsp; &nbsp; - указать наименование статуса<br /> &nbsp; &nbsp; &nbsp; - указать примечание для ЛК</p></td><td><p>1010</p></td></tr><tr><td><p>9. Требуется ли формирование документов-результатов (талон, сертификат ДО, ЕПД,...) -&nbsp; ПДФ для статусов<br /> &nbsp; &nbsp; - указать код(ы) статуса(ов), в которых формируется документ<br /> &nbsp;&nbsp; &nbsp;- приложить шаблон(ы)&nbsp;<br /> &nbsp; &nbsp; - указать код документа в ЦХЭД и его класс (если есть требование сохранения в ЦХЭД)<br /> &nbsp; &nbsp; - убедиться, что в схеме статуса для данных, передаваемых кодом по справочнику, есть данные для разименования и приложить схему и пример статуса&nbsp;</p></td><td><p>&nbsp;Документ-результат формирует ведомство и размещает в ЦХЭД вместе с ЭП.</p><p>Печатное представление PDF с синей меткой необходимо реализовать файлом с сохранением в РЦХЭД для обеспечения последующей выгрузки файла ИС ОИВ.</p></td></tr><tr><td><p>10. Валидировать требования к статусной модели.<br /> &nbsp; &nbsp; - требуется ли модифицировать и как таблицу statusroute или&nbsp;statusroute_xxx<br /> &nbsp; &nbsp; - если можете, подготовить скрипты создания и/или наполнения таблиц логирования и описания статусов<br /> &nbsp;&nbsp;&nbsp; - есть ли доп действия</p></td><td><p>Файлы <span>statusroute лежат по адресу:</span> !Услуги\\КГСН\\РС и РВ\\2020\\Рабочая</p><p><br /></p><p>&nbsp;Доп. действие:</p><p>Отзыв заявления (10090)</p></td></tr><tr><td><p>11. Если на форме нужны данные из Кэш ЕТП или непосредственно из ИС ОИВ<br /> &nbsp; &nbsp; &nbsp;- указать источники (строка подключения, сертификат) на тестовом стенде<br /> &nbsp; &nbsp; &nbsp;- указать описание получаемых данных<br /> &nbsp; &nbsp; &nbsp;- указать описание поставляемых данных</p></td><td><p>Нет</p></td></tr><tr><td><p>12. Для услуг ЕФСП:<br /> &nbsp; &nbsp; &nbsp;- подготовить XSD схему для подачи заявки/записи черновика/...&nbsp;<br /> &nbsp; &nbsp; &nbsp;- подготовить требования к сервисам<br /> &nbsp; &nbsp; &nbsp;- если есть требования к ФЛК описать их, предоставляя xpath к элементам сообщений</p></td><td><p>!Услуги\\КГСН\\РС и РВ\\2020\\Рабочая\\XSD</p></td></tr><tr><td><p>13. Указать, нужна ли регистрация заявки на МПГУ/ЕЛК (если источник заявки не МПГУ, а статусы в ЕЛК доставлять нужно по бизнесу)</p></td><td><p>&nbsp;Нет</p></td></tr><tr><td><p>14. Указать модель информирования (уведомления/оповещения):<br /> &nbsp;&nbsp;&nbsp; - ЕТП-МПГУ-ЕМП-ЕЛК<br /> &nbsp;&nbsp;&nbsp; - ЕТП-ЕЛК<br /> &nbsp;&nbsp;&nbsp; - ЕТП-ЕФП-ПИВ-ЕЛК</p></td><td><ul><li>АИС РиН-ЕТП-ЕФП-ПИВ-ИС ПК</li><li><span>АИС РиН</span>-ЕТП-ЕФП-ПИВ-ЕЛК</li></ul><ul><li>АИС МГН-ЕТП-ЕФП-ПИВ-ИС ПК</li><li>АИС МГН-ЕТП-ЕФП-ПИВ-ЕЛК</li></ul></td></tr><tr><td><p>15. Является ли услуга Подпиской на уведомления/оповещения<br /> &nbsp;&nbsp;&nbsp; - Код уведомления для формирования ЕНО<br /> &nbsp;&nbsp;&nbsp; - Нужна ли автоматическая подписка</p></td><td><p>&nbsp;Нет</p></td></tr><tr><td><p>16. Дать ссылку в SeaFile на АТР, ЧТЗ, XSD, примеры XML, ...&nbsp;</p></td><td><p>ETP\\!Услуги\\КГСН\\РС и РВ\\2020</p></td></tr></tbody></table><h3 class=\"auto-cursor-target\"><strong>Ссылки на репозитории</strong></h3><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.021101\">https://github.com/mbuyakov/EFP.RSRV.021101</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.000241\">https://github.com/mbuyakov/EFP.RSRV.000241</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065801\">https://github.com/mbuyakov/EFP.RSRV.065801</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065701\">https://github.com/mbuyakov/EFP.RSRV.065701</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065501\">https://github.com/mbuyakov/EFP.RSRV.065501</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.065601\">https://github.com/mbuyakov/EFP.RSRV.065601</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.029401\">https://github.com/mbuyakov/EFP.RSRV.029401</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.026701\">https://github.com/mbuyakov/EFP.RSRV.026701</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.021001\">https://github.com/mbuyakov/EFP.RSRV.021001</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV.029301\">https://github.com/mbuyakov/EFP.RSRV.029301</a></p><p><a href=\"https://github.com/mbuyakov/EFP.RSRV\">https://github.com/mbuyakov/EFP.RSRV</a></p><p><a href=\"https://github.com/mbuyakov/ETP.RIN\">https://github.com/mbuyakov/ETP.RIN</a></p><p><a href=\"https://github.com/mbuyakov/ETP.RIN_TRSH\">https://github.com/mbuyakov/ETP.RIN_TRSH</a></p><p><a href=\"https://github.com/mbuyakov/ETP.MGN\">https://github.com/mbuyakov/ETP.MGN</a></p><h3><br /><strong>Ссылка в Api Store</strong></h3><p><a href=\"https://efp6.sm-soft.ru:9443/store/site/pages/list-apis.jag?page=1&amp;tag=%D0%A0%D0%A1%20%D0%A0%D0%92\">https://efp6.sm-soft.ru:9443/store/site/pages/list-apis.jag?page=1&amp;tag=%D0%A0%D0%A1%20%D0%A0%D0%92</a><strong><br /></strong></p><h3><strong>Краткое описание</strong></h3><p>В данных услугах используется архитектура ЕФП-ЕТП. При вызове REST-сервисов ЕФП происходит следующая обработка запроса:</p><p>1) Валидация JSON-запроса;</p><p>2) Стандартная валидация WSO2 и СУДИР</p><p>3) Вызов EfspSignService. Для ФЛ используется метод convertAndSend, для ЮЛ - createRequest, sendRequest.</p><p><br /></p><p><br /></p><p><br /></p><p><br /></p>";
        BasicConfigurator.configure();

        WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();
        AlternativeFormatInputPart afiPart = new AlternativeFormatInputPart(new PartName("/hw.html"));
        afiPart.setBinaryData(html.getBytes());
        afiPart.setContentType(new ContentType("text/html"));
        Relationship altChunkRel = wordMLPackage.getMainDocumentPart().addTargetPart(afiPart);

// .. the bit in document body
        CTAltChunk ac = Context.getWmlObjectFactory().createCTAltChunk();
        ac.setId(altChunkRel.getId() );
        wordMLPackage.getMainDocumentPart().addObject(ac);

// .. content type
        wordMLPackage.getContentTypeManager().addDefaultContentType("html", "text/html");
        wordMLPackage.save(new java.io.File(System.getProperty("user.dir") + "/test.docx"));

    }
}
